<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Revision Test | By Abinaya Samuel</title>
    
    <meta name="theme-color" content="#ffffff">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="ref.png">

    <style>
        :root {
            --primary-orange: #F58220;
            --primary-yellow: #FDB913;
            --primary-blue: #0071BC;
            --primary-green: #4DB848;
            --bg-white: #ffffff;
            --text-dark: #1a1a1a;
            --text-grey: #666;
            --font-main: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: var(--font-main);
            background-color: var(--bg-white);
            color: var(--text-dark);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* --- Navigation --- */
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 5%;
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo-img {
            height: 40px;
            width: auto;
        }

        .brand-name {
            font-weight: 800;
            font-size: 1.2rem;
            letter-spacing: -0.5px;
        }

        .brand-sub {
            font-size: 0.7rem;
            color: var(--text-grey);
            font-weight: normal;
            display: block;
        }

        .nav-links button {
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 600;
            margin-left: 15px;
            padding: 8px 16px;
            transition: 0.3s;
        }

        .btn-login {
            background-color: var(--primary-blue) !important;
            color: white;
            border-radius: 20px;
        }

        .btn-scroll { color: var(--text-dark); }

        /* --- Hero Section (Brutal Design) --- */
        .hero {
            padding: 80px 5%;
            text-align: center;
            max-width: 900px;
            margin: 0 auto;
        }

        .hero h1 {
            font-size: 3.5rem;
            line-height: 1.1;
            margin-bottom: 20px;
            font-weight: 900;
            background: -webkit-linear-gradient(45deg, var(--primary-orange), var(--primary-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .hero p.brutal-sub {
            font-size: 1.5rem;
            color: var(--text-dark);
            margin-bottom: 30px;
            font-weight: 700;
        }

        .hero p.small-text {
            color: var(--text-grey);
            font-size: 1.1rem;
            margin-bottom: 40px;
        }

        /* --- Auth Modal --- */
        #authModal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.95);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .auth-box {
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 400px;
            border: 1px solid #eee;
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #eee;
        }

        .tab {
            flex: 1;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            font-weight: bold;
            color: var(--text-grey);
        }

        .tab.active {
            color: var(--primary-blue);
            border-bottom: 2px solid var(--primary-blue);
        }

        .input-group {
            margin-bottom: 15px;
            position: relative;
        }

        .input-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
        }

        .toggle-password {
            position: absolute;
            right: 10px;
            top: 12px;
            cursor: pointer;
            font-size: 0.9rem;
            color: var(--primary-blue);
            font-weight: bold;
        }

        .btn-submit {
            width: 100%;
            padding: 12px;
            background: var(--primary-green);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
        }

        .link-text {
            text-align: center;
            margin-top: 15px;
            font-size: 0.9rem;
            color: var(--primary-blue);
            cursor: pointer;
            text-decoration: underline;
        }

        .loader {
            display: none;
            text-align: center;
            margin-top: 10px;
            color: var(--primary-blue);
        }

        /* --- Exam Grid --- */
        .exam-section {
            padding: 60px 5%;
            background: #fafafa;
        }

        .exam-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-top: 40px;
        }

        .exam-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.03);
            transition: transform 0.2s;
            border-top: 5px solid var(--primary-blue);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .exam-card:hover {
            transform: translateY(-5px);
        }

        .exam-card h3 {
            margin-bottom: 10px;
            font-size: 1.4rem;
        }

        .exam-card p {
            font-size: 0.9rem;
            color: var(--text-grey);
            margin-bottom: 20px;
        }

        .exam-action-btn {
            display: block;
            width: 100%;
            padding: 12px;
            text-align: center;
            border-radius: 6px;
            text-decoration: none;
            font-weight: bold;
            transition: 0.3s;
        }

        .btn-locked {
            background: white;
            border: 2px solid var(--primary-orange);
            color: var(--primary-orange);
        }

        .btn-locked:hover {
            background: var(--primary-orange);
            color: white;
        }

        .btn-unlocked {
            background: var(--primary-green);
            color: white;
            border: 2px solid var(--primary-green);
        }

        /* --- Footer --- */
        footer {
            background: #111;
            color: white;
            padding: 40px 5%;
            margin-top: 60px;
            text-align: center;
        }

        .contact-info {
            margin-top: 20px;
            font-size: 0.9rem;
            color: #888;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .hero h1 { font-size: 2.5rem; }
            .hero p.brutal-sub { font-size: 1.2rem; }
            nav { flex-direction: column; gap: 10px; }
            .nav-links { width: 100%; display: flex; justify-content: center; }
        }
    </style>
</head>
<body>

    <nav>
        <div class="logo-container">
            <img src="ref.png" alt="Logo" class="logo-img">
            <div>
                <div class="brand-name">Revision Test</div>
                <span class="brand-sub">By Abinaya Samuel</span>
            </div>
        </div>
        <div class="nav-links">
            <button class="btn-scroll" onclick="scrollToExams()">View Exams</button>
            <button id="authBtn" class="btn-login" onclick="openAuth()">Login / Sign Up</button>
            <button id="logoutBtn" class="btn-scroll" style="display:none;" onclick="handleLogout()">Logout</button>
        </div>
    </nav>

    <section class="hero">
        <h1>Big EdTech is Lying to You.</h1>
        <p class="brutal-sub">Stop wasting time on 100-hour lectures. You don't need them.</p>
        <p class="small-text">
            They want you to pay for videos you'll never watch. We want you to pass. <br>
            Learn today with ChatGPT & Gemini. <strong>Test yourself here.</strong>
        </p>
        <button class="btn-login" style="padding: 15px 40px; font-size: 1.1rem;" onclick="scrollToExams()">Start Practicing Now</button>
    </section>

    <section class="exam-section" id="exams">
        <h2 style="text-align: center;">Available Mock Tests</h2>
        <div class="exam-grid" id="examGrid">
            </div>
    </section>

    <footer>
        <h3>Revision Test</h3>
        <div class="contact-info">
            <p>Developed by Abinaya Samuel</p>
            <p>Phone: +91 8754955367 | Email: revisiontestapp@gmail.com</p>
            <p>&copy; 2026 Revision Test. All rights reserved.</p>
        </div>
    </footer>

    <div id="authModal">
        <div class="auth-box">
            <div style="text-align: right;"><span style="cursor:pointer; font-size: 1.5rem;" onclick="closeAuth()">&times;</span></div>
            
            <div class="auth-tabs" id="tabHeaders">
                <div class="tab active" onclick="switchTab('login')">Login</div>
                <div class="tab" onclick="switchTab('signup')">Sign Up</div>
            </div>

            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="input-group">
                    <input type="email" id="loginEmail" placeholder="Email Address" required>
                </div>
                <div class="input-group">
                    <input type="password" id="loginPass" placeholder="Password" required>
                    <span class="toggle-password" onclick="togglePass('loginPass')">üëÅÔ∏è</span>
                </div>
                <button type="submit" class="btn-submit">Login</button>
                <div class="link-text" onclick="showForgot()">Forgot Password?</div>
            </form>

            <form id="signupForm" style="display:none;" onsubmit="handleSignup(event)">
                <div class="input-group">
                    <input type="text" id="regName" placeholder="Full Name" required>
                </div>
                <div class="input-group">
                    <input type="email" id="regEmail" placeholder="Email Address" required>
                </div>
                <div class="input-group">
                    <input type="tel" id="regPhone" placeholder="Phone Number" required>
                </div>
                <div class="input-group">
                    <input type="password" id="regPass" placeholder="Password" required>
                    <span class="toggle-password" onclick="togglePass('regPass')">üëÅÔ∏è</span>
                </div>
                <button type="submit" class="btn-submit">Create Account</button>
            </form>

            <form id="forgotForm" style="display:none;" onsubmit="handleForgot(event)">
                <h3 style="text-align:center; margin-bottom:15px;">Reset Password</h3>
                <div class="input-group">
                    <input type="email" id="forgotEmail" placeholder="Enter your registered email" required>
                </div>
                <button type="submit" class="btn-submit">Send Reset Code</button>
                <div class="link-text" onclick="switchTab('login')">Back to Login</div>
            </form>

            <form id="resetForm" style="display:none;" onsubmit="handleReset(event)">
                <h3 style="text-align:center; margin-bottom:15px;">Enter New Password</h3>
                <p style="font-size:0.8rem; text-align:center; color:green; margin-bottom:10px;">Check your email for the code!</p>
                <div class="input-group">
                    <input type="text" id="resetCode" placeholder="Enter 6-digit Code" required>
                </div>
                <div class="input-group">
                    <input type="password" id="newPass" placeholder="New Password" required>
                </div>
                <button type="submit" class="btn-submit">Update Password</button>
            </form>
            
            <div id="authLoader" class="loader">Processing... Please wait.</div>
            <p id="authMessage" style="text-align: center; margin-top: 10px; color: red; font-size: 0.9rem;"></p>
        </div>
    </div>

    <script>
        // --- CONFIGURATION ---
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxF8qO1a2BzRHZ6DDfZmHecCQZQWr_-Hvs5ddIEumwvVGAL8HDf81JIbUXiM9c8nFzb/exec'; // <--- PASTE YOUR DEPLOYED URL
        const API_KEY = 'ldbvay88end89u3lrcx38yy83b@43smsvfiop'; // <--- MUST MATCH THE KEY IN YOUR GOOGLE SHEET SCRIPT

        // Exam Data & Pricing
        const exams = [
            { id: 'NEET', name: 'NEET', html: 'NEET.html', price: '‚Çπ1499', dummyLink: 'www.razorapy.com_neet' },
            { id: 'JEE', name: 'JEE Mains & Advanced', html: 'JEE.html', price: '‚Çπ1499', dummyLink: 'www.razorapy.com_jee' },
            { id: 'UPSC', name: 'UPSC CSE', html: 'UPSC.html', price: '‚Çπ1999', dummyLink: 'www.razorapy.com_upsc' },
            { id: 'SSC_CGL', name: 'SSC CGL', html: 'SSC_CGL.html', price: '‚Çπ699', dummyLink: 'www.razorapy.com_ssc_cgl' },
            { id: 'SSC_CHSL', name: 'SSC CHSL', html: 'SSC_CHSL.html', price: '‚Çπ499', dummyLink: 'www.razorapy.com_ssc_chsl' },
            { id: 'BANKING', name: 'Banking (IBPS/SBI)', html: 'BANKING.html', price: '‚Çπ799', dummyLink: 'www.razorapy.com_banking' },
            { id: 'RRB_NTPC', name: 'RRB NTPC', html: 'RRB_NTPC.html', price: '‚Çπ499', dummyLink: 'www.razorapy.com_rrb' },
            { id: 'IELTS', name: 'IELTS', html: 'IELTS.html', price: '‚Çπ1299', dummyLink: 'www.razorapy.com_ielts' },
            { id: 'NCLEXRN', name: 'NCLEX-RN', html: 'NCLEXRN.html', price: '‚Çπ2499', dummyLink: 'www.razorapy.com_nclex' },
            { id: 'HAAD', name: 'HAAD', html: 'HAAD.html', price: '‚Çπ2499', dummyLink: 'www.razorapy.com_haad' }
        ];

        // --- APP LOGIC ---

        function init() {
            checkLoginStatus();
            renderExams();
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('sw.js').catch(console.error);
            }
        }

        function checkLoginStatus() {
            const user = JSON.parse(localStorage.getItem('currentUser'));
            if (user) {
                document.getElementById('authBtn').style.display = 'none';
                document.getElementById('logoutBtn').style.display = 'inline-block';
                document.getElementById('logoutBtn').textContent = `Logout (${user.name.split(' ')[0]})`;
            } else {
                document.getElementById('authBtn').style.display = 'inline-block';
                document.getElementById('logoutBtn').style.display = 'none';
            }
        }

        function renderExams() {
            const grid = document.getElementById('examGrid');
            const user = JSON.parse(localStorage.getItem('currentUser'));
            
            grid.innerHTML = ''; 

            exams.forEach(exam => {
                const card = document.createElement('div');
                card.className = 'exam-card';
                
                let hasAccess = false;
                if (user && user.access && user.access[exam.id] === true) {
                    hasAccess = true;
                }

                let buttonHtml = '';
                if (hasAccess) {
                    buttonHtml = `<a href="${exam.html}" class="exam-action-btn btn-unlocked">Start Test</a>`;
                } else {
                    buttonHtml = `<a href="https://${exam.dummyLink}" target="_blank" class="exam-action-btn btn-locked">Unlock for ${exam.price}</a>`;
                }

                card.innerHTML = `
                    <div>
                        <h3>${exam.name}</h3>
                        <p>Complete Mock Test Series. 80+ Tests included.</p>
                    </div>
                    ${buttonHtml}
                `;
                grid.appendChild(card);
            });
        }

        // --- AUTH UI FUNCTIONS ---

        function openAuth() { document.getElementById('authModal').style.display = 'flex'; }
        function closeAuth() { document.getElementById('authModal').style.display = 'none'; }
        
        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            // Reset views
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('signupForm').style.display = 'none';
            document.getElementById('forgotForm').style.display = 'none';
            document.getElementById('resetForm').style.display = 'none';
            document.getElementById('tabHeaders').style.display = 'flex';

            if(tab === 'login') {
                document.querySelector('.tab:nth-child(1)').classList.add('active');
                document.getElementById('loginForm').style.display = 'block';
            } else {
                document.querySelector('.tab:nth-child(2)').classList.add('active');
                document.getElementById('signupForm').style.display = 'block';
            }
        }

        function showForgot() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('tabHeaders').style.display = 'none'; // Hide tabs
            document.getElementById('forgotForm').style.display = 'block';
        }

        function showReset() {
            document.getElementById('forgotForm').style.display = 'none';
            document.getElementById('resetForm').style.display = 'block';
        }

        function togglePass(id) {
            const input = document.getElementById(id);
            input.type = input.type === 'password' ? 'text' : 'password';
        }

        function scrollToExams() {
            document.getElementById('exams').scrollIntoView({ behavior: 'smooth' });
        }

        function handleLogout() {
            localStorage.removeItem('currentUser');
            location.reload();
        }

        // --- BACKEND API CALLS ---

        function showLoader(show) {
            document.getElementById('authLoader').style.display = show ? 'block' : 'none';
        }

        function showMsg(msg, color='red') {
            const el = document.getElementById('authMessage');
            el.innerText = msg;
            el.style.color = color;
        }

        async function postData(action, data) {
            showLoader(true);
            showMsg('');
            try {
                const formData = new FormData();
                formData.append('action', action);
                formData.append('apiKey', API_KEY); // SECURE API KEY
                
                for (const key in data) {
                    formData.append(key, data[key]);
                }

                const response = await fetch(SCRIPT_URL, { method: 'POST', body: formData });
                return await response.json();
            } catch (err) {
                console.error(err);
                return { success: false, message: 'Connection Error' };
            } finally {
                showLoader(false);
            }
        }

        async function handleLogin(e) {
            e.preventDefault();
            const res = await postData('login', {
                email: document.getElementById('loginEmail').value,
                password: document.getElementById('loginPass').value
            });

            if (res.success) {
                localStorage.setItem('currentUser', JSON.stringify(res.user));
                showMsg('Login Successful!', 'green');
                setTimeout(() => { closeAuth(); init(); }, 1000);
            } else {
                showMsg(res.message);
            }
        }

        async function handleSignup(e) {
            e.preventDefault();
            const res = await postData('signup', {
                name: document.getElementById('regName').value,
                email: document.getElementById('regEmail').value,
                phone: document.getElementById('regPhone').value,
                password: document.getElementById('regPass').value,
                deviceId: navigator.userAgent // Simple device tracking
            });

            if (res.success) {
                localStorage.setItem('currentUser', JSON.stringify(res.user));
                showMsg('Account Created!', 'green');
                setTimeout(() => { closeAuth(); init(); }, 1000);
            } else {
                showMsg(res.message);
            }
        }

        // 1. Send Forgot Password Code
        async function handleForgot(e) {
            e.preventDefault();
            const email = document.getElementById('forgotEmail').value;
            const res = await postData('forgot_password', { email: email });

            if (res.success) {
                // Store email temporarily for next step
                localStorage.setItem('resetEmail', email);
                showMsg('Code sent! Check Email.', 'green');
                setTimeout(() => { showReset(); }, 1500);
            } else {
                showMsg(res.message);
            }
        }

        // 2. Verify Code & Update Password
        async function handleReset(e) {
            e.preventDefault();
            const res = await postData('reset_password', {
                email: localStorage.getItem('resetEmail'),
                code: document.getElementById('resetCode').value,
                newPassword: document.getElementById('newPass').value
            });

            if (res.success) {
                showMsg('Password Updated! Please Login.', 'green');
                setTimeout(() => { switchTab('login'); }, 2000);
            } else {
                showMsg(res.message);
            }
        }

        // Initialize App
        window.onload = init;

    </script>
</body>
</html>
